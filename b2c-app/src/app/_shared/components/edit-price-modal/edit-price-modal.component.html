<div class="modal-dialog editpriceDialog" role="document">
  <div class="modal-content dialog_content">
    <div class="modal-body mdl_body">
      <div *ngIf="itinerary">
        <div class="d-flex justify-content-end">
          <button type="button" class="close mb-3" data-dismiss="modal" aria-label="Close" (click)="handleClose()">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="mb-3 form-group d-none" [formGroup]="editModalValidate">
          <label for="email" >Email Address</label>
          <input
            type="text"
            class="form-control"
            placeholder="abc@mail.com"
            #emailAddress
            autocomplete="off"
            formControlName="email"
            required
          />
          <div *ngIf="isSubmitted && editModalValidate.controls['email'].hasError" class="col-12 px-0">
            <div class="error_msg" *ngIf="isSubmitted && editModalValidate.controls['email'].hasError('required')">
              Email address is required
            </div>
            <div class="error_msg" *ngIf="isSubmitted && editModalValidate.controls['email'].hasError('pattern')">
              Invalid Email address
            </div>
          </div>
        </div>
        <div *ngIf="tripType == MULTI || tripType == MULTI_CITY">
          <div class="filght-details pb-3 mb-3" *ngFor="let odoList of itinerary.odoList; let idx = index">
            <div class="flight-details-top pl-3 py-2">
              <span
                ><strong>Trip {{ idx + 1 }} |</strong>
                {{ itinerary.odoList[idx].segments[0].departureDateTime | date: 'EEEE, d
             MMMM' }} |
                {{ flights.airlineNames[itinerary.odoList[idx].segments[0].airlineCode] }}
              </span>
            </div>

            <div class="row">
              <div class="" [ngClass]="idx + 1 == itinerary.odoList.length ? 'col-md-8' : 'col-md-12'">
                <app-flight-details-view [odoList]="itinerary.odoList[idx]"></app-flight-details-view>
              </div>
              <div class="col-md-4 py-3" *ngIf="idx + 1 == itinerary.odoList.length">
                <app-edit-price-form 
                  [itinerary]="itinerary"
                  (additionalMarkupEvnt)="additionalMarkup($event)"
                  (updateDiscountEvnt)="updateDiscount($event)"
                  (isShowDiscountOnQuote)="isShowDiscountOnQuote($event)"
                ></app-edit-price-form>
              </div>
            </div>
          </div>
        </div>
        <div class="filght-details pb-3 mb-3" *ngIf="tripType !== MULTI && tripType !== MULTI_CITY">
          <div class="flight-details-top pl-3 py-2">
            <span
              ><strong>Departure |</strong>
              {{ itinerary.odoList[0].segments[0].departureDateTime | date: 'EEEE, d
              MMMM' }} |
              {{ flights.airlineNames[itinerary.odoList[0].segments[0].airlineCode] }}
            </span>
          </div>
          <div class="row">
            <div class="" [ngClass]="tripType == ONE_WAY ? 'col-md-8' : 'col-md-12'">
              <app-flight-details-view [odoList]="itinerary.odoList[ARRAY_ZERO_INDEX]"></app-flight-details-view>
            </div>
            <div class="col-md-4 py-3" *ngIf="tripType == ONE_WAY">
              <app-edit-price-form  
                [itinerary]="itinerary"
                (additionalMarkupEvnt)="additionalMarkup($event)"
                (updateDiscountEvnt)="updateDiscount($event)"
                (isShowDiscountOnQuote)="isShowDiscountOnQuote($event)"
              ></app-edit-price-form>
            </div>
          </div>
        </div>

        <div class="filght-details pb-3 mb-4" *ngIf="tripType === RETURN">
          <div class="flight-details-top pl-3 py-2">
            <span
              ><strong>Return</strong> | {{  itinerary.odoList[itinerary.odoList.length-1].segments[0].departureDateTime | date: 'EEEE, d MMMM' }} |
              {{ flights.airlineNames[itinerary.odoList[itinerary.odoList.length-1].segments[0].airlineCode] }}
            </span>
          </div>
          <div class="row">
            <div class="col-md-8">
              <app-flight-details-view [odoList]="itinerary.odoList[ARRAY_FIRST_INDEX]"></app-flight-details-view>
            </div>
            <div class="col-md-4 pt-3">
              <app-edit-price-form 
                [itinerary]="itinerary"
                (additionalMarkupEvnt)="additionalMarkup($event)"
                (updateDiscountEvnt)="updateDiscount($event)"
                (isShowDiscountOnQuote)="isShowDiscountOnQuote($event)"
              ></app-edit-price-form>
            </div>
          </div>
        </div>

        <div class="d-none d-lg-block">
          <div class="d-flex align-items-center justify-content-between">
            <div>
              <button
                class="download-quote primary_btn"
                (click)="generateBookingPriceQuote()"
                [disabled]="isDownloadingQuoteBtnDisabled"
                [ngClass]="{ 'disable-cursor opacity05': isDownloadingQuoteBtnDisabled }"
              >
                <i class="fa fa-spinner fa-spin text-white" *ngIf="isDownloadingQuote" aria-hidden="true"></i>
                Download
              </button>
            </div>
            <div class="d-flex button-section">
              <div class="d-flex button-section">
                <button
                  class="update-btn mr-3 primary_btn"
                  *ngIf="!isDiscountApplied"
                  (click)="onSubmit()"

                >
                  <i class="fa fa-spinner fa-spin text-primary" *ngIf="isSendingQuote" aria-hidden="true"></i>
                  UPDATE
                </button>
                <button
                  class="update-btn mr-3 "
                  *ngIf="isDiscountApplied"
                  (click)="continueWithDiscountedFareHandler(); closeSnackbar()"
                >
                  <i class="fa fa-spinner fa-spin text-primary" *ngIf="isSendingQuote" aria-hidden="true"></i>
                  CONTINUE WITH UPDATED FARE
                </button>
                <button class="continue-btn" (click)="continueWithSameFareHandler()">
                  CONTINUE TO SAME FARE
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="d-block d-lg-none">
          <div>
            <button class="continue-btn w-100" (click)="continueWithSameFareHandler()">
              CONTINUE TO SAME FARE
            </button>
          </div>
          <div class="d-flex mt-3">
            <button
              class="download-quote flex-fill primary_btn "
              (click)="generateBookingPriceQuote()"
              [disabled]="isDownloadingQuoteBtnDisabled"
              [ngClass]="{ opacity05: isDownloadingQuoteBtnDisabled }"
            >
              <i class="fa fa-spinner fa-spin text-white" *ngIf="isDownloadingQuote" aria-hidden="true"></i>
                Download
            </button>
            <button
              class="update-btn ml-3 flex-fill primary_btn"
              *ngIf="!isDiscountApplied"
              (click)="onSubmit()"
              [disabled]="isUpdateButtonDisabled"
            >
              <i class="fa fa-spinner fa-spin text-primary" *ngIf="isSendingQuote" aria-hidden="true"></i>
              UPDATE
            </button>
            <button
              class="continue-discount-btn ml-3 flex-fill "
              *ngIf="isDiscountApplied"
              (click)="continueWithDiscountedFareHandler(); closeSnackbar()"
            >
              <i class="fa fa-spinner fa-spin text-primary" *ngIf="isSendingQuote" aria-hidden="true"></i>
              CONTINUE WITH UPDATED FARE
            </button>
          </div>
        </div>
        <div *ngIf="viewBookingPriceQuote">
          <app-edit-price-quote
            [quoteNumber]="quoteNumber"
            [displayDiscountonQuote]="displayDiscountonQuote"
            [itinerary]="itinerary"
            [tripType]="tripType"
            [updatedPrice]="fareQuotePriceDetails()"
            (invoiceDownloadEvent)="updateDownloadQuote()"
          >
          </app-edit-price-quote>
        </div>
      </div>
    </div>
  </div>
</div>
