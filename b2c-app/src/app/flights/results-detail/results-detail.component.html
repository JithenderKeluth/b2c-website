<div id="resultDetailModal">
  <app-back-button (onBack)="onBack($event)">
    <span translate>Flight Details</span>
  </app-back-button>
  <app-booking-flowcoundown></app-booking-flowcoundown>

  <div class="flight-itinerary" *ngIf="itinerary?.odoList">
    <div class="flight-itinerary__container container">
      <div class="flight-itinerary__journey" *ngFor="let odo of itinerary.odoList; let idx = index">
        <div class="flight-itinerary__journey-summary">
          <h2 class="flight-itinerary__journey-dest" *ngIf="getJourneyDestination(idx) as dest">
            <span translate>Flight to </span>
            <span>{{ dest.city }}</span>
          </h2>
            <div class="d-flex align-items-center">
                <h3 class="flight-itinerary__journey-date" *ngIf="getJourneyDepartureDateTime(odo) as departure">
                  {{ departure | date:'EEEE, d MMM yyyy' }}
                </h3>

                <div class="flight-itinerary__journey-duration ">
                  <span *ngIf="getJourneyStops(odo) as stops">{{ stops }}</span>
                  <span class="mx-1"> | </span>
                  <span *ngIf="getJourneyDuration(odo) as duration">{{ duration }}</span>
                </div>
            </div>
        </div>

        <div class="flight-itinerary__segments" *ngIf="odo.segments">
          <ng-container *ngFor="let segment of odo.segments; let idx = index; let first = first; let last = last;">
            <!-- Flight segment -->
            <div class="flight-segment">
              <!-- Airline -->
              <div class="flight-segment__airline" *ngIf="segment.airlineCode">
                <img
                  class="flight-segment__airline-logo"
                  ImageSrc
                  src="assets/img/carriers/retina48px/carrier-{{ segment.airlineCode }}.png"
                  [alt]="segment.airlineCode"
                  width="28"
                  height="28"
                  loading="lazy"
                />
                <div class="flight-segment__airline-name" *ngIf="getAirlineName(segment.airlineCode) as airline">{{ airline }}
                  <div class="flight-segment__flight-number" *ngIf="getFlightNumber(segment) as flightNumber">Flight {{ flightNumber }}</div>
                </div>
              </div>

              <div class="flight-segment__line">
                <div class="flight-segment__line-end"></div>
                <div class="flight-segment__line-fill"></div>
                <div class="flight-segment__line-end"></div>
              </div>

              <div class="flight-segment__breakdown">
                <!-- Departure -->
                <div class="flight-segment__airport-lbl" *ngIf="first">Departure</div>
                <div class="flight-segment__airport">
                  <div class="flight-segment__airport-time" [class.changeToSBColor]="first">{{ segment.departureDateTime | date:'HH:mm' }}</div>
                  <div class="flight-segment__airport-code">{{ segment.origCode }}</div>
                  <div class="flight-segment__airport-name" *ngIf="getAirportInfo(segment.origCode) as airport">{{ airport.airport }}</div>
                </div>
                <div class="flight-segment__airport-date">{{ segment.departureDateTime | date:'EEEE, d MMM yyyy'  }}</div>

                <!-- Duration -->
                <div class="flight-segment__duration">
                  <span translate>Flight time</span>
                  <span>{{ this.formatDuration(segment.duration) }}</span>
                </div>

                <!-- Arrival -->
                <div class="flight-segment__airport-lbl" *ngIf="last">Arrival</div>
                <div class="flight-segment__airport">
                  <div class="flight-segment__airport-time" [class.changeToSBColor]="last">{{ segment.arrivalDateTime | date:'HH:mm' }}</div>
                  <div class="flight-segment__airport-code">{{ segment.destCode }}</div>
                  <div class="flight-segment__airport-name" *ngIf="getAirportInfo(segment.destCode) as airport">{{ airport.airport }}</div>
                </div>
                 <div class="flight-segment__airport-date" >{{ segment.arrivalDateTime | date:'EEEE, d MMM yyyy'  }}</div>
              </div>
            </div>

            <div class="flight-segment__layover" *ngIf="!last">
              <div class="flight-segment__layover-warning">
                <img
                  class="flight-segment__layover-icn"
                  ImageSrc
                  src="../../../assets/icons/standardbank_icons/hourglass.svg"
                  alt="hourglass"
                  width="24"
                  height="24"
                  loading="lazy"
                />

                <span translate>Layover for</span>
                <span>{{ calculateLayover(segment.arrivalDateTime, odo.segments[idx+1].departureDateTime) }}</span>
              </div>
            </div>
          </ng-container>
        </div>
      </div>

      <button
        id="confirmBtn"
        type="button"
        aria-label="Confirm"
        class="confirm-btn btn primary_btn book_btn onHover"
        (click)="onConfirm()"
        translate
      >
        Confirm
      </button>
    </div>
  </div>
</div>
